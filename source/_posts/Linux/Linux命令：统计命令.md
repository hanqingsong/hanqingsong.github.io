---
title: Linux 命令：统计命令
date: 2017-10-18 19:58:23
categories:
  - Linux
tags:
  - 命令
---
一些实用的Linux文本操作命令，包括wc(统计)、cut(切分)、sort(排序)、uniq(去重)、grep(查找)、sed(替换、插入、删除)、awk(文本分析)。

## wc(统计)
```
# wc [-lwm]
选项与参数：
-l  ：仅列出行；
-w  ：仅列出多少字(英文单字)；
-m  ：多少字符；
```

## cut(切分)
```
cut  [-bn] [file] 或 cut [-c] [file]  或  cut [-df] [file]
　　使用说明
　　cut 命令从文件的每一行剪切字节、字符和字段并将这些字节、字符和字段写至标准输出。
　　如果不指定 File 参数，cut 命令将读取标准输入。必须指定 -b、-c 或 -f 标志之一。

　　主要参数
　　-b ：以字节为单位进行分割。这些字节位置将忽略多字节字符边界，除非也指定了 -n 标志。
　　-c ：以字符为单位进行分割。
　　-d ：自定义分隔符，默认为制表符。
　　-f ：与-d一起使用，指定显示哪个区域。
　　-n ：取消分割多字节字符。仅和 -b 标志一起使用。如果字符的最后一个字节落在由 -b 标志的 List 参数指示的<br />范围之内，该字符将被写出；否则，该字符将被排除。
```

## sort(排序)
```
　　sort命令是帮我们依据不同的数据类型进行排序，其语法及常用参数格式：

sort [-bcfMnrtk][源文件][-o 输出文件] 
　　补充说明：sort可针对文本文件的内容，以行为单位来排序。

　　参数：
　　-b   忽略每行前面开始出的空格字符。
　　-c   检查文件是否已经按照顺序排序。
　　-f   排序时，忽略大小写字母。
　　-M   将前面3个字母依照月份的缩写进行排序。
　　-n   依照数值的大小排序。
　　-o<输出文件>   将排序后的结果存入指定的文件。
　　-r   以相反的顺序来排序。
　　-t<分隔字符>   指定排序时所用的栏位分隔字符。
　　-k  选择以哪个区间进行排序。
```

## uniq(去重)
uniq命令可以去除排序过的文件中的重复行，因此uniq经常和sort合用。也就是说，为了使uniq起作用，所有的重复行必须是相邻的。
```
# uniq [-icu]
选项与参数：
-i   ：忽略大小写字符的不同；
-c  ：进行计数
-u  ：只显示唯一的行
```

## grep(查找)
```
Linux系统中grep命令是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹 配的行打印出来。grep全称是Global Regular Expression Print，表示全局正则表达式版本，它的使用权限是所有用户。

grep [options]
　　主要参数
　　[options]主要参数：
　　－c：只输出匹配行的计数。
　　－I：不区分大 小写(只适用于单字符)。
　　－h：查询多文件时不显示文件名。
　　－l：查询多文件时只输出包含匹配字符的文件名。
　　－n：显示匹配行及 行号。
　　－s：不显示不存在或无匹配文本的错误信息。
　　－v：显示不包含匹配文本的所有行。
    -E：使用正则
　　pattern正则表达式主要参数：
　　\： 忽略正则表达式中特殊字符的原有含义。
　　^：匹配正则表达式的开始行。
　　$: 匹配正则表达式的结束行。
　　\<：从匹配正则表达 式的行开始。
　　\>：到匹配正则表达式的行结束。
　　[ ]：单个字符，如[A]即A符合要求 。
　　[ - ]：范围，如[A-Z]，即A、B、C一直到Z都符合要求 。
　　。：所有的单个字符。
　　* ：有字符，长度可以为0。
```

## sed(替换、插入、删除)
sed是一个很好的文件处理工具，本身是一个管道命令，主要是以行为单位进行处理，可以将数据行进行替换、删除、新增、选取等特定工作，下面先了解一下sed的用法。sed命令行格式为：
```
sed [-nefri] ‘command’ 输入文本 
　　常用选项：
　　  -n∶使用安静(silent)模式。在一般 sed 的用法中，所有来自 STDIN的资料一般都会被列出到萤幕上。但如果加上 -n 参数后，则只有经过sed 特殊处理的那一行(或者动作)才会被列出来。
        -e∶直接在指令列模式上进行 sed 的动作编辑；
        -f∶直接将 sed 的动作写在一个档案内， -f filename 则可以执行 filename 内的sed 动作；
        -r∶sed 的动作支援的是延伸型正规表示法的语法。(预设是基础正规表示法语法)
        -i∶直接修改读取的档案内容，而不是由萤幕输出。       

　　常用命令：
        a   ∶新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)～
        c   ∶取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！
        d   ∶删除，因为是删除啊，所以 d 后面通常不接任何咚咚；
　　   i   ∶插入， i 的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；
　　  p  ∶列印，亦即将某个选择的资料印出。通常 p 会与参数 sed -n 一起运作～
　　  s  ∶取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！
```

### sed 提取匹配的字符串内容
```
# STR="MAIL FROM(CCC) TO(DDD)"
# echo $STR | sed 's/^.*FROM(\(.*\)).*TO(\(.*\)).*$/\1-\2/g'
CCC-DDD
```

s表示替换，组匹配信息\(.*\),第一个为\1,第二个\2以此类推

```
"09/Jan/2018:00:02:58 +0800","210.22.172.146","-","-","-","api.fastschool.cn","ded92c009aaa4582a6cf9b644fa62aa6","GET /clog/a.gif?action=FS_UploadLog&clientIp=%28null%29&clientVersion=3.8.7&debugInfo=20180108__NumOfLine_117_&logType=debug&logVersion=1.0&netType=wifi&osName=iPad&osVersion=10.3&platform=iOS&tag=FSUploadLog&ts=2018-01-09%2000%3A02%3A56.784&userLid=a91e0cffbe474635b8ec4861a58b1a97&userToken=ded92c009aaa4582a6cf9b644fa62aa6&wifiName=TP-LINK_BF2AF0 HTTP/1.1","-","-","prod:stu_cli, channel:AppStore, os:iOS, osVer:10.3.3, mobile:iPad, vName:3.8.7, env:RE","200","0.000","0","-","-","*/*","nginx-111","-"

# less loginfo.txt |awk -F'","' '{print $8}' |sed 's/^.*\(action=[a-zA-Z_]*\).*\(platform=[a-zA-Z_]*\).*$/\1  \2/g'

action=FS_StartUploadLog_ToCOS  platform=iOS
```

## awk(文本分析)
awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。简单来说awk就是把文件逐行的读入，以空格为默认分隔符将每行切片，切开的部分再进行各种分析处理
```
awk '{pattern + action}' {filenames}
```
尽管操作可能会很复杂，但语法总是这样，其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花括号（{}）不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。 pattern就是要表示的正则表达式，用斜杠括起来。

　　awk语言的最基本功能是在文件或者字符串中基于指定规则浏览和抽取信息，awk抽取信息后，才能进行其他文本操作。完整的awk脚本通常用来格式化文本文件中的信息。

　　通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本。


## 参考
博客出处：http://www.cnblogs.com/maybe2030/ 
